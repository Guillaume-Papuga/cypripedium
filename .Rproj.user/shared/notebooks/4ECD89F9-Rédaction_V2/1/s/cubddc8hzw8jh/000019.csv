"0",""
"0","# -------------------------------"
"0","# 5. Matrice de transition S1 → S2"
"0","# -------------------------------"
"0","matrice_psi_S2_S3 <- psi_lisible_S2_S3 %>%"
"0","  select(etat, etat_suivant, psi) %>%"
"0","  pivot_wider("
"0","    names_from = etat_suivant,"
"0","    values_from = psi,"
"0","    values_fill = 0"
"0","  )"
"0",""
"0","psi_matrix_S2_S3 <- matrice_psi_S2_S3 %>%"
"0","  column_to_rownames(""etat"") %>%"
"0","  as.matrix()"
"0",""
"0","psi_matrix_S2_S3"
"1","  "
"1","          j"
"1","        nf"
"1","         ff"
"1","          F"
"1","
j "
"1"," 0.89516129"
"1"," 0.1048387"
"1"," 0.00000000"
"1"," 0.00000000"
"1","
nf"
"1"," 0.05882353"
"1"," 0.8907563"
"1"," 0.03361345"
"1"," 0.01680672"
"1","
f "
"1"," 0.00000000"
"1"," 0.0000000"
"1"," 0.46875000"
"1"," 0.53125000"
"1","
ff"
"1"," 0.00000000"
"1"," 0.0000000"
"1"," 1.00000000"
"1"," 0.00000000"
"1","
"
"0","# Vérification"
"0","rowSums(psi_matrix_S2_S3)"
"1"," j "
"1","nf "
"1"," f "
"1","ff "
"1","
"
"1"," 1 "
"1"," 1 "
"1"," 1 "
"1"," 1 "
"1","
"
"0","# -------------------------------"
"0","# 6. Visualisation avec DiagrammeR"
"0","# -------------------------------"
"0","library(DiagrammeR)"
"0",""
"0","states <- c(""j"", ""nf"", ""f"", ""ff"", ""F"")"
"0",""
"0","dot_code <- ""digraph pheno_transitions_S2_S3 {"
"0","  rankdir=LR;"
"0","  node [shape=circle, style=filled, color=lightblue, fontname=Helvetica];"
"0",""""
"0",""
"0","for(i in rownames(psi_matrix_S2_S3)){"
"0","  for(j in colnames(psi_matrix_S2_S3)){"
"0","    prob <- psi_matrix_S2_S3[i, j]"
"0","    if(!is.na(prob) && prob > 0){"
"0","      dot_code <- paste0("
"0","        dot_code,"
"0","        i, "" -> "", j,"
"0","        "" [label=\"""", round(prob, 3), ""\""];\n"""
"0","      )"
"0","    }"
"0","  }"
"0","}"
"0",""
"0","dot_code <- paste0(dot_code, ""}"")"
"0","grViz(dot_code)"

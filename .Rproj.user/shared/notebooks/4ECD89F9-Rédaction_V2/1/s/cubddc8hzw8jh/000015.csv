"0","# -------------------------------"
"0","# 1. Charger les données"
"0","# -------------------------------"
"0","data <- data_original"
"0",""
"0","# -------------------------------"
"0","# 2. Préparer les données phénologiques"
"0","# -------------------------------"
"0","phenology_codes <- c(""j"" = 1, ""nf"" = 2, ""f"" = 3, ""ff"" = 4, ""F"" = 5)"
"0",""
"0","phenologie_S2_S3 <- data %>%"
"0","  dplyr::select(ID_ind, phenoS2, phenoS3) %>%"
"0","  mutate("
"0","    phenoS2 = phenology_codes[phenoS2],"
"0","    phenoS3 = phenology_codes[phenoS3]"
"0","  ) %>%"
"0","  mutate("
"0","    phenoS2 = replace_na(phenoS2, 0),"
"0","    phenoS3 = replace_na(phenoS3, 0)"
"0","  )"
"0",""
"0","# -------------------------------"
"0","# 3. Calcul empirique des transitions S1 → S2"
"0","# -------------------------------"
"0","transitions_S2_S3 <- phenologie_S2_S3 %>%"
"0","  filter(phenoS2 != 0 & phenoS3 != 0) %>%  # exclure absents"
"0","  count(phenoS2, phenoS3, name = ""n"")"
"0",""
"0","# Probabilités de transition"
"0","psi_S2_S3 <- transitions_S2_S3 %>%"
"0","  group_by(phenoS2) %>%"
"0","  mutate(psi = n / sum(n)) %>%"
"0","  ungroup()"
"0",""
"0","psi_S2_S3"

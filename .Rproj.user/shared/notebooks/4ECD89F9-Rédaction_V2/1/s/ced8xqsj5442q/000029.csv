"0",""
"0","#Matrice de probabilité de transition"
"0","matrice_psi_transi_tot <- psi_lisible_transi_tot %>%"
"0","  select(etat, etat_suivant, psi) %>%"
"0","  pivot_wider("
"0","    names_from = etat_suivant,"
"0","    values_from = psi,"
"0","    values_fill = 0"
"0","  )"
"0",""
"0","psi_matrix_transi_tot <- matrice_psi_transi_tot %>%"
"0","  column_to_rownames(""etat"") %>%  # 'etat' devient les noms de lignes"
"0","  as.matrix()"
"0",""
"0","psi_matrix_transi_tot"
"1","  "
"1","          j"
"1","        nf"
"1","          f"
"1","          ff"
"1","          F"
"1","
j "
"1"," 0.64263323"
"1"," 0.3416928"
"1"," 0.01253918"
"1"," 0.003134796"
"1"," 0.00000000"
"1","
nf"
"1"," 0.05370844"
"1"," 0.8644501"
"1"," 0.05115090"
"1"," 0.020460358"
"1"," 0.01023018"
"1","
f "
"1"," 0.00000000"
"1"," 0.0000000"
"1"," 0.19512195"
"1"," 0.390243902"
"1"," 0.41463415"
"1","
ff"
"1"," 0.00000000"
"1"," 0.0000000"
"1"," 0.00000000"
"1"," 1.000000000"
"1"," 0.00000000"
"1","
"
"0","#Vérification"
"0","rowSums(psi_matrix_transi_tot)"
"1"," j "
"1","nf "
"1"," f "
"1","ff "
"1","
"
"1"," 1 "
"1"," 1 "
"1"," 1 "
"1"," 1 "
"1","
"
"0","states <- c(""j"", ""nf"", ""f"", ""ff"", ""F"")"
"0",""
"0","psi_matrix_full_transi_tot <- matrix("
"0","  0,"
"0","  nrow = length(states),"
"0","  ncol = length(states),"
"0","  dimnames = list(states, states)"
"0",")"
"0",""
"0","# Insertion de ta matrice observée"
"0","psi_matrix_full_transi_tot["
"0","  rownames(psi_matrix_transi_tot),"
"0","  colnames(psi_matrix_transi_tot)"
"0","] <- psi_matrix_transi_tot"
"0",""
"0","# -------------------------------"
"0","# 4. Visualisation avec DiagrammeR"
"0","# -------------------------------"
"0","library(DiagrammeR)"
"0",""
"0","states <- c(""j"", ""nf"", ""f"", ""ff"", ""F"")"
"0","num_states <- length(states)"
"0",""
"0","dot_code <- ""digraph pheno_transitions { "
"0","  rankdir=LR;"
"0","  node [shape=circle, style=filled, color=lightblue, fontname=Helvetica];"
"0","  j; nf; f; ff; F;"
"0",""""
"0",""
"0","for(i in 1:num_states){"
"0","  for(j in 1:num_states){"
"0","    prob <- psi_matrix_full_transi_tot[i,j]"
"0","    if(!is.na(prob) && prob > 0){"
"0","      dot_code <- paste0(dot_code, states[i], "" -> "", states[j], "
"0","                         "" [label=\"""", round(prob, 3), ""\""];\n"")"
"0","    }"
"0","  }"
"0","}"
"0",""
"0","dot_code <- paste0(dot_code, ""}"")"
"0","grViz(dot_code)"
